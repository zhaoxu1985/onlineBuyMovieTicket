(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["room"],{"27db":function(e,t,a){},a727:function(e,t,a){e.exports=a.p+"img/screen.74765005.png"},ac10:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[e._v("首页")]),a("el-breadcrumb-item",[e._v("电影管理")]),a("el-breadcrumb-item",[e._v("添加影片")])],1),a("el-card",{staticStyle:{"margin-top":"10px"},attrs:{width:"100%"}},[a("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.addInfoForm,rules:e.rules,"label-width":"100px"}},[a("el-row",{attrs:{align:"bottom"}},[a("el-card",[a("el-col",{staticClass:"add-movie-img-path",attrs:{span:5}},[a("div",{directives:[{name:"show",rawName:"v-show",value:!(e.addInfoForm.main_pic.length>0),expression:"addInfoForm.main_pic.length > 0 ? false : true"}],staticClass:"main_pic_preview"}),a("img",{directives:[{name:"show",rawName:"v-show",value:0!=e.addInfoForm.main_pic.length,expression:"addInfoForm.main_pic.length == 0 ? false : true"}],staticClass:"main_pic",attrs:{src:e.addInfoForm.main_pic}})]),a("el-col",{attrs:{span:19}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"电影价格",prop:"movie_price"}},[a("el-input",{model:{value:e.addInfoForm.movie_price,callback:function(t){e.$set(e.addInfoForm,"movie_price",t)},expression:"addInfoForm.movie_price"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"主图URL",prop:"main_pic"}},[a("el-input",{model:{value:e.addInfoForm.main_pic,callback:function(t){e.$set(e.addInfoForm,"main_pic",t)},expression:"addInfoForm.main_pic"}})],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"是否在售",prop:"is_sale"}},[a("el-switch",{model:{value:e.addInfoForm.is_sale,callback:function(t){e.$set(e.addInfoForm,"is_sale",t)},expression:"addInfoForm.is_sale"}})],1)],1),a("el-col",{attrs:{span:10}},[a("el-form-item",{attrs:{label:"是否预售",prop:"is_presell"}},[a("el-switch",{model:{value:e.addInfoForm.is_presell,callback:function(t){e.$set(e.addInfoForm,"is_presell",t)},expression:"addInfoForm.is_presell"}})],1)],1)],1)],1)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px"}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"电影简介",prop:"movie_about"}},[a("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入电影简介"},model:{value:e.addInfoForm.movie_about,callback:function(t){e.$set(e.addInfoForm,"movie_about",t)},expression:"addInfoForm.movie_about"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"电影名称",prop:"movie_name"}},[a("el-input",{model:{value:e.addInfoForm.movie_name,callback:function(t){e.$set(e.addInfoForm,"movie_name",t)},expression:"addInfoForm.movie_name"}})],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"电影类型",prop:"movie_type"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择"},model:{value:e.addInfoForm.movie_type,callback:function(t){e.$set(e.addInfoForm,"movie_type",t)},expression:"addInfoForm.movie_type"}},e._l(e.movieTypeOptions,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"语言",prop:"language"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选择语言"},model:{value:e.addInfoForm.language,callback:function(t){e.$set(e.addInfoForm,"language",t)},expression:"addInfoForm.language"}},e._l(e.movieLanguage,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1)],1),a("el-card",{staticStyle:{"margin-top":"10px"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"上映时间",prop:"online_time"}},[a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择日期",format:"yyyy-MM-dd","picker-options":e.pickerOptions},model:{value:e.addInfoForm.online_time,callback:function(t){e.$set(e.addInfoForm,"online_time",t)},expression:"addInfoForm.online_time"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"上映地点",prop:"online_place"}},[a("el-select",{attrs:{clearable:"",placeholder:"请选上映地点"},model:{value:e.addInfoForm.online_place,callback:function(t){e.$set(e.addInfoForm,"online_place",t)},expression:"addInfoForm.online_place"}},e._l(e.moviePlace,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"电影时长",prop:"time_length"}},[a("el-input",{attrs:{placeholder:"60,80,120..."},model:{value:e.addInfoForm.time_length,callback:function(t){e.$set(e.addInfoForm,"time_length",t)},expression:"addInfoForm.time_length"}})],1)],1),a("el-col",{staticClass:"addBtn",attrs:{span:24}},[a("el-button",{attrs:{type:"success"},on:{click:function(t){return e.addMovieInfoBtn("ruleForm")}}},[e._v("添加")])],1)],1)],1)],1)],1)],1)},s=[],i={data(){var e=(e,t,a)=>{var o=/(http|https):\/\/.+(\.jpg|\.png)/gi;o.test(t)?a():a(new Error("请输入正确链接"))},t=(e,t,a)=>{var o=/(^[1-9]\d*(\.\d{1,2})?$)|(^0(\.\d{1,2})?$)/;o.test(t)?t<1?this.$notify({title:"警告",message:"请输入价格",type:"warning"}):a():a(new Error("请输入正确格式,最多两位小数"))},a=(e,t,a)=>{0==t.length&&a(new Error("请输入电影时长")),Number.isInteger(Number(t))?a():a(new Error("请输入数字类型"))};return{addInfoForm:{movie_name:"",movie_type:"",online_time:"",online_place:"",is_presell:!1,time_length:Number(),main_pic:"",movie_about:"",movie_price:Number().toFixed(1),is_sale:!0,language:"",play_type:"",d_order:0},rules:{movie_name:[{required:!0,message:"请输入电影名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],online_time:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}],movie_type:[{required:!0,message:"请选择电影类型",trigger:"change"}],online_place:[{required:!0,message:"请选择上映地点",trigger:"change"}],time_length:[{validator:a,trigger:"blur"}],main_pic:[{validator:e,trigger:"blur"}],movie_about:[{required:!0,message:"请输入电影简介(10-500个字符)",trigger:"blur"},{min:10,max:500,message:"长度在 10 到 500 个字符",trigger:"blur"}],movie_price:[{validator:t,trigger:"blur"}],language:[{required:!0,message:"请选择电影语言",trigger:"change"}],play_type:[{required:!0,message:"请选择播放类型",trigger:"change"}]},movieLanguage:[{value:"国语",label:"国语"},{value:"英语",label:"英语"},{value:"粤语",label:"粤语"},{value:"韩语",label:"韩语"},{value:"印度",label:"印度"},{value:"俄语",label:"俄语"}],movieTypeOptions:[{value:"2D",label:"2D"},{value:"2D IMAX",label:"2D IMAX"},{value:"3D",label:"3D"},{value:"3D IMAX",label:"英语3D IMAX"}],pickerOptions:{shortcuts:[{text:"明天",onClick(e){e.$emit("pick",(new Date).setDate((new Date).getDate()+1))}},{text:"今天",onClick(e){e.$emit("pick",new Date)}},{text:"昨天",onClick(e){const t=new Date;t.setTime(t.getTime()-864e5),e.$emit("pick",t)}},{text:"一周前",onClick(e){const t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}}]},moviePlace:[{value:"中国大陆",label:"中国大陆"},{value:"好莱坞",label:"好莱坞"},{value:"美国",label:"美国"},{value:"韩国",label:"韩国"},{value:"印度",label:"印度"},{value:"日本",label:"日本"},{value:"俄罗斯",label:"俄罗斯"},{value:"加拿大",label:"加拿大"}]}},methods:{addMovieInfoBtn(e){this.$refs[e].validate(async e=>{if(!e)return this.$notify({title:"警告",message:"请输入完整的信息",type:"warning"}),!1;{let{data:e}=await this.$axios.post("/addinfo/",this.addInfoForm);if(200!=e.meta.status)return this.$notify.error("添加失败,电影名称存在 ");this.$notify.success("添加成功"),console.log(e)}})}}},l=i,r=(a("b73c"),a("2877")),n=Object(r["a"])(l,o,s,!1,null,"44ebf9b8",null);t["default"]=n.exports},b73c:function(e,t,a){"use strict";a("27db")},be42:function(e,t,a){},e831:function(e,t,a){"use strict";a("be42")},eb2f:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[o("el-breadcrumb-item",{attrs:{to:{path:"/now"}}},[o("font",{staticClass:"itemFont"},[e._v("首页")])],1),o("el-breadcrumb-item",[o("font",{staticClass:"itemFont"},[e._v("影厅管理")])],1),o("el-breadcrumb-item",[o("font",{staticClass:"itemFont"},[e._v("添加影厅")])],1)],1),o("el-card",{staticClass:"topCard",attrs:{shadow:"always"}},[o("el-input",{staticStyle:{width:"20%"},model:{value:e.searchInput,callback:function(t){e.searchInput=t},expression:"searchInput"}}),o("el-button",{staticClass:"searchBtn",attrs:{type:"info",icon:"el-icon-search",round:""},on:{click:e.searchBtn}}),o("el-button",{staticClass:"searchBtn",attrs:{type:"danger",icon:"el-icon-delete",round:""},on:{click:e.searchBtnClear}}),o("el-button",{staticClass:"addRoomBtn",attrs:{type:"success"},on:{click:e.addRoomDialog}},[e._v(" 添加影厅")])],1),o("el-card",{staticClass:"topCard",attrs:{shadow:"always"}},[o("el-table",{staticStyle:{width:"100%"},attrs:{data:e.movieDataList,border:""}},[o("el-table-column",{attrs:{prop:"r_name",label:"影厅名称",width:"180"}}),o("el-table-column",{attrs:{prop:"r_size",label:"影厅大小",width:"180"}}),o("el-table-column",{attrs:{prop:"r_rows",label:"总行"}}),o("el-table-column",{attrs:{prop:"r_cols",label:"总列"}}),o("el-table-column",{attrs:{prop:"editor",label:"编辑"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("div",[o("el-button",{attrs:{size:"small",type:"info"},on:{click:function(a){return e.selectRoomBtn(t.row)}}},[e._v("查看")]),o("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(a){return e.editorRoomBtn(t.row)}}},[e._v("编辑")]),o("el-popconfirm",{attrs:{"confirm-button-text":"好的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"这是一段内容确定删除吗？"},on:{confirm:function(a){return e.deleteRoom(t.row)}}},[o("el-button",{attrs:{slot:"reference",size:"small",type:"danger"},slot:"reference"},[e._v("删除")])],1)],1)]}}])})],1),o("div",{staticClass:"block"},[o("el-pagination",{attrs:{"current-page":e.page.nowPage,"page-sizes":[5,10,15,20],"page-size":e.page.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.page.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),o("el-dialog",{staticStyle:{"background-color":"#F8F7F7"},attrs:{visible:e.addRoomDialogVisible,width:"100%","before-close":e.addRoomHandleClose},on:{"update:visible":function(t){e.addRoomDialogVisible=t}}},[o("div",{staticClass:"add-dia classlog-box",style:"height:"+e.seatBoxH},[o("el-row",[o("el-col",{staticStyle:{height:"100vh"},attrs:{span:7}},[o("div",{staticClass:"editBtnBox"},[o("el-tooltip",{attrs:{effect:"dark",content:"可拖动选择",placement:"bottom"}},[o("el-button",{staticClass:"untifyWidhtBtn",attrs:{type:"success"},on:{click:function(t){e.btnState=!0}}},[o("i",{staticClass:"el-icon-bianji iconfont"}),e._v("选择可用座位(可拖动)")])],1),o("el-tooltip",{attrs:{effect:"dark",content:"可拖动选择",placement:"bottom"}},[o("el-button",{staticClass:"untifyWidhtBtn",attrs:{type:"danger"},on:{click:function(t){e.btnState=!1}}},[o("i",{staticClass:"el-icon-bianji iconfont"}),e._v("选择不可用(可拖动)")])],1),0==e.isEditStatus?o("el-form",{ref:"addRuleForm",staticClass:"demo-ruleForm",attrs:{model:e.addRoom,"status-icon":"",rules:e.rules}},[o("el-form-item",{attrs:{label:"影厅名称",prop:"r_name"}},[o("el-input",{staticClass:"untifyWidht",attrs:{placeholder:"请输入影厅名称",clearable:""},model:{value:e.addRoom.r_name,callback:function(t){e.$set(e.addRoom,"r_name",t)},expression:"addRoom.r_name"}})],1),o("el-form-item",{attrs:{label:"总行数",prop:"r_rows"}},[o("el-input",{staticClass:"untifyWidht",attrs:{placeholder:"请输入总行数",clearable:""},model:{value:e.addRoom.r_rows,callback:function(t){e.$set(e.addRoom,"r_rows",t)},expression:"addRoom.r_rows"}})],1),o("el-form-item",{attrs:{label:"总列数",prop:"r_cols"}},[o("el-input",{staticClass:"untifyWidht",attrs:{placeholder:"请输入总列数",clearable:""},model:{value:e.addRoom.r_cols,callback:function(t){e.$set(e.addRoom,"r_cols",t)},expression:"addRoom.r_cols"}})],1),o("el-form-item",{attrs:{prop:"screen_location"}},[e._v("\n                                屏幕位置\n                                "),o("el-input",{staticClass:"untifyWidht",staticStyle:{width:"70px","margin-right":"30px",padding:"0px"},model:{value:e.addRoom.screen_location.x,callback:function(t){e.$set(e.addRoom.screen_location,"x",t)},expression:"addRoom.screen_location.x"}}),e._v(" 至\n                                "),o("el-input",{staticClass:"untifyWidht",staticStyle:{width:"70px"},model:{value:e.addRoom.screen_location.y,callback:function(t){e.$set(e.addRoom.screen_location,"y",t)},expression:"addRoom.screen_location.y"}})],1)],1):e._e(),0==e.isEditStatus?o("el-button",{staticStyle:{"margin-top":"20px"},attrs:{type:"danger"},on:{click:function(t){return e.clearAddRoom("addRuleForm")}}},[e._v("清空\n                        ")]):e._e(),0==e.isEditStatus?o("el-button",{staticStyle:{"margin-top":"20px"},on:{click:e.preview}},[e._v("生成座位\n                        ")]):e._e(),o("div",{staticStyle:{"margin-top":"50px"}},[o("el-button",{on:{click:e.addRoomDialogcancel}},[e._v("取 消")]),0==e.isEditStatus?o("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.addLoading,expression:"addLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:function(t){return e.addRoomDialogFinish("addRuleForm")}}},[e._v("\n                                添加")]):e._e(),1==e.isEditStatus?o("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.addLoading,expression:"addLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary"},on:{click:function(t){return e.EditRoomDialogFinish("addRuleForm")}}},[e._v("\n                                保存")]):e._e()],1)],1)]),o("el-col",{style:"height:"+e.addRoom.r_rows<5?"100vh":e.seatBoxH,attrs:{span:16}},[o("div",{ref:"seatBoxRefs",style:"height:"+e.seatBoxH,attrs:{id:"seatbox"}},[o("div",{staticClass:"topSelectScript"},e._l(Number(e.addScripCols),(function(t){return o("div",{key:t,style:"width:"+e.stripWH+"px;margin:5px 5px 0px 5px;text-align:center;font-size:15px;color:white;"},[e._v(e._s(t))])})),0),o("div",{staticClass:"leftSelectScript"},e._l(Number(e.addScripRows),(function(t){return o("div",{key:t,style:"height:"+Number(e.stripWH+3.5)+"px; display: flex;align-items: center;justify-content: center;margin:5px;text-align:center;font-size:15px;color:white;"},[e._v(e._s(t))])})),0),o("div",{staticClass:"addScreenLocation",style:"margin:5px 5px 0px 5px;left:"+e.addScreenLocationLeft+"px;width:"+e.addScreenLocationW+"px"},[e._v("\n                            "+e._s(e.addScripName)+"\n                        ")]),o("drag-select-container",{attrs:{selectorClass:"item"},on:{change:function(t){return e.selectChange(t)}},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.addRoom.seat_state,(function(a,s){return o("div",{key:s,ref:"seat",refInFor:!0,class:e.getClasses(a,t),style:e.formatItemWidth,attrs:{x:a.x,y:a.y,"data-item":a.key}})}))}}])})],1)])],1)],1)]),o("el-dialog",{attrs:{title:"查看",visible:e.selectVisible,width:"500px","before-close":e.selectBeforeClose},on:{"update:visible":function(t){e.selectVisible=t}}},[o("div",{staticClass:"view-preview"},[o("div",{staticClass:"view-preview-box"},[o("div",{staticClass:"select-screen-box"},[o("div",{staticClass:"select-screen-box-header"},[o("div",{staticClass:"select-screen-box-header-left"},[o("i",{staticClass:"el-icon-arrow-left"})]),o("div",{staticClass:"select-screen-box-header-right"},[o("i",{staticClass:"el-icon-more"})])]),o("div",{staticClass:"select-screen-box-center"},[o("div",{style:e.seatAnimation+";width:"+e.selectWH.w+"px;height:"+e.selectWH.h+"px;left:-"+e.selectMleft+"px;top:-"+e.selectMtop+"px;display:inline-block;transition:1.5s all;position:absolute;"},e._l(e.seatFormat,(function(t,a){return o("div",{key:a},e._l(t,(function(t,a){return o("div",{key:a,staticClass:"selectSeatW",style:1==t.isNull?e.selectSuccess:e.selectError},[e._v(e._s(t.a)+"\n                                ")])})),0)})),0)])]),o("img",{attrs:{width:"350px",src:a("a727"),alt:""}})])]),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(t){e.selectVisible=!1}}},[e._v("取消")]),o("el-button",{attrs:{type:"primary"},on:{click:function(t){e.selectVisible=!1}}},[e._v("确定")])],1)])],1)},s=[],i=a("9556"),l={components:{"drag-select-container":i["a"]},data(){let e=/\D/g,t=(e,t,a)=>{""==t.length&&a(new Error("请输入")),a()},a=(t,a,o)=>{e.test(a)&&o(new Error("只能输入数字")),""==a.length&&o(new Error("请输入")),o()},o=(t,a,o)=>{if(e.test(a))return o(new Error("只能输入数字"));""==a.length&&o(new Error("请输入")),o()},s=(t,a,o)=>{if(e.test(a.x)||e.test(a.y))return o(new Error("只能输入数字"));""!=a.x.length&&""!=a.y.length||o(new Error("请输入")),o()};return{rules:{r_name:[{validator:t,trigger:"blur"}],r_rows:[{validator:a,trigger:"blur"}],r_cols:[{validator:o,trigger:"blur"}],screen_location:[{validator:s,trigger:"blur"}]},seatFormat:[],seatAnimation:"transform: scale(1);",selectWH:{},selectMleft:"",selectMtop:"",selectSuccess:"background-image:url('https://z3.ax1x.com/2021/04/02/ceOVvq.png');",selectError:"background-color:rgba(0,0,0,0);",customClass:"customClass",stripWH:"",selectVisible:!1,list:[],item:[],addRoomDialogVisible:!1,addSetNull:"addSetNull",addSuccess:"addSuccess",searchInput:"",movieDataList:Array(),page:{nowPage:1,pageSize:5,total:Number()},addScripCols:Number(),addScripRows:Number(),addScripName:"",seatBoxH:"100vh",addScreenLocationLeft:Number(),addScreenLocationW:Number(),addRoom:{r_rows:Number(),r_cols:Number(),r_name:String(),screen_location:{x:Number(),y:Number()},seat_state:[],count_seat:""},formatItemWidth:"",selectedList:[],btnState:!0,addLoading:!1,addBeforeRoomDialogVisible:!1,isEditStatus:!1}},methods:{async selectRoomBtn(e){console.log(e);let{data:t}=await this.$axios.get("room/"+e.r_id);if(200!=t.meta.status)return this.$message.error("获取失败");this.addRoom=t.data;let a=[];for(let i=0;i<this.addRoom.r_rows;i++){a[i]=[];for(let e=0;e<this.addRoom.seat_state.length;e++)this.addRoom.seat_state[e].x==i+1&&a[i].push(this.addRoom.seat_state[e])}this.seatFormat=a,console.log(a);let o=25*(this.addRoom.r_cols+3),s=25*(this.addRoom.r_rows+3);console.log(o+">>"+s),this.selectWH={w:o,h:s},o<278?(this.selectMleft=0,this.selectMtop=0):(this.selectMleft=(o-278)/2,this.selectMtop=(s-278)/2),this.seatAnimation="transform:scale(1)",setTimeout(()=>{this.seatAnimation="transform:scale(0.3)"},500),this.selectVisible=!0},async deleteRoom(e){console.log(e);const t=this.$loading({lock:!0,text:"删除中",spinner:"el-icon-loading",background:"hsla(0,0%,100%,.9)"});let{data:a}=await this.$axios.delete("room",{data:{r_id:e.r_id}});setTimeout(()=>{t.close(),this.$message.success("删除成功"),1==this.movieDataList.length&&(this.page.nowPage=this.page.nowPage-1),this.getRoomList()},500)},async EditRoomDialogFinish(){let{data:e}=await this.$axios.post("/room/edit",this.addRoom);if(console.log(e),200!=e.meta.status)return this.$message.error("修改失败");this.$message.success("修改成功"),this.addRoomDialogcancel(),this.clearAddromFun()},async editorRoomBtn(e){let{data:t}=await this.$axios.get("/room/"+e.r_id);this.addRoom=t.data,this.addRoomDialogVisible=!0,this.$nextTick(e=>{this.preview();let t=this.$refs.seat;console.log(t);for(let a=0;a<t.length;a++){let e=t[a].getAttribute("x"),o=t[a].getAttribute("y");for(let s=0;s<this.addRoom.seat_state.length;s++)this.addRoom.seat_state[s].x==e&&this.addRoom.seat_state[s].y==o&&(0==this.addRoom.seat_state[s].isNull&&(t[a].style.backgroundImage='url("https://z3.ax1x.com/2021/04/02/ceLq4H.png")'),1==this.addRoom.seat_state[s].isNull&&(t[s].style.backgroundImage='url("https://z3.ax1x.com/2021/04/02/ceOVvq.png")'))}}),this.isEditStatus=!0},selectBeforeClose(e){this.$confirm("确认关闭？").then(t=>{e()}).catch(e=>{})},addResetForm(e){this.$refs[e].resetFields()},addRoomDialogFinish(e){this.$refs[e].validate(async e=>{if(!e)return this.$message.warning("请输入完整信息");{let e=0;for(let a=0;a<this.addRoom.seat_state.length;a++)0!=this.addRoom.seat_state[a].isNull&&e++;if(0==e)return this.$message.error("你还没有选择可用选座位");let{data:t}=await this.$axios.post("room",this.addRoom);if(console.log(this.addRoom),200!=t.meta.status)return this.addLoading=!1,this.$message.error(t.meta.msg);this.$message.success("添加成功"),this.addLoading=!1,this.addRoomDialogVisible=!1,this.getRoomList(),this.clearAddromFun(),this.clearBeforeAddRoom(),this.addRoom.screen_location={},this.isEditStatus=!1}})},addRoomDialogcancel(){this.addRoomDialogVisible=!1,this.clearAddromFun(),this.addRoom.seat_state=[],this.clearBeforeAddRoom(),this.addRoom.screen_location={}},clearAddRoom(e){this.$confirm("此操作将清除座位信息, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(e=>{this.addRoom.seat_state=[],this.addRoom.screen_location={x:"",y:""},this.clearBeforeAddRoom(),this.clearAddromFun()}).catch(e=>{})},clearBeforeAddRoom(){this.addScreenLocationLeft=Number(),this.addScreenLocationW=Number(),this.addScripName="",this.addScripCols="",this.addScripRows=""},clearAddromFun(){this.addRoom.r_rows="",this.addRoom.r_cols="",this.addRoom.r_name="",this.addScreenLocationW=Number(),this.addScreenLocationLeft=Number(),this.addRoom.seat_state=[],this.addRoom.screen_location={x:"",y:""},this.addRoom.count_seat=""},getClasses(e,t){const a=t.selectedItems.find(t=>parseInt(t.dataset.item,10)===e.key);return{item:!0,active:a}},selectChange(e){console.log(e);for(let t=0;t<this.addRoom.seat_state.length;t++)for(let a=0;a<e.length;a++)e[a].getAttribute("x")==this.addRoom.seat_state[t].x&&e[a].getAttribute("y")==this.addRoom.seat_state[t].y&&(0==this.btnState&&(this.addRoom.seat_state[t].isNull=0,e[a].style.backgroundImage='url("https://z3.ax1x.com/2021/04/02/ceLq4H.png")',e[a].style.backgroundSize="100%"),1==this.btnState&&(this.addRoom.seat_state[t].isNull=1,e[a].style.backgroundImage='url("https://z3.ax1x.com/2021/04/02/ceOVvq.png")',e[a].style.backgroundSize="100%"))},handleSizeChange(e){console.log(`每页 ${e} 条`),this.page.pageSize=e,this.getRoomList()},handleCurrentChange(e){console.log("当前页: "+e),this.page.nowPage=e,this.getRoomList()},addRoomDialog(){this.addRoomDialogVisible=!0,this.isEditStatus=!1},async searchBtn(){if(this.searchInput.length<1)return this.$message.warning("请输入搜索内容哦");let{data:e}=await this.$axios.get("/room",{params:{...this.page,searchInput:this.searchInput}});this.page.total=e.total,this.movieDataList=e.data},searchBtnClear(){this.getRoomList(),this.searchInput=""},async getRoomList(){let{data:e}=await this.$axios.get("/room",{params:this.page});console.log(this.movieDataList),this.page.total=e.total,this.movieDataList=e.data},addRoomHandleClose(e){this.$confirm("确认关闭？").then(t=>{this.addRoom.seat_state=[],this.clearBeforeAddRoom(),this.clearAddromFun(),e()}).catch(e=>{})},editDragStart(e,t){},clickFormatItemWidth(){let e=800/this.addRoom.r_cols-10,t=0;for(let o=0;o<this.addRoom.r_rows;o++)t+=e+10;this.seatBoxH=t+"px",console.log(t);for(let o=Number(this.addRoom.screen_location.x-1);o<Number(this.addRoom.screen_location.y);o++)this.addScreenLocationW+=800/this.addRoom.r_cols,console.log("屏幕宽度+"+o);for(let o=1;o<this.addRoom.screen_location.x;++o)this.addScreenLocationLeft+=Number(e+10);let a=`width:${e}px;height:${e}px;display:inline-block;margin:5px 5px 0px 5px;border-radius:10px`;this.formatItemWidth=a,this.stripWH=e},preview(){if(this.addScripCols=this.addRoom.r_cols,this.addScripRows=this.addRoom.r_rows,0==this.isEditStatus&&0!=this.addRoom.seat_state.length)return this.$message.error("已经生成,生成前先点击清除");this.addScripName=this.addRoom.r_name,this.clickFormatItemWidth();let e=0,t=[];if(0==this.isEditStatus){for(let a=0;a<this.addRoom.r_rows;a++)for(let o=0;o<this.addRoom.r_cols;o++)t.push({isNull:0,state:0,x:a+1,y:o+1,key:e,uid:""}),e++;this.addRoom.seat_state=t}console.log(this.addRoom)}},created(){this.getRoomList(),this.innerWidth=window.innerWidth},mounted(){},computed:{}},r=l,n=(a("e831"),a("2877")),d=Object(n["a"])(r,o,s,!1,null,null,null);t["default"]=d.exports}}]);
//# sourceMappingURL=room.bb5bc7a4.js.map