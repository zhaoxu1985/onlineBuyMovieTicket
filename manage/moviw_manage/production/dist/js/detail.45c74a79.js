(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["detail"],{"089d":function(t,e,i){"use strict";i("e6aa")},1251:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),i("el-breadcrumb-item",[t._v("电影管理")]),i("el-breadcrumb-item",[t._v("编辑信息")])],1),i("el-card",[i("el-select",{attrs:{"filter-method":t.filterMethods,filterable:"",placeholder:"请选择电影"},model:{value:t.searchValue,callback:function(e){t.searchValue=e},expression:"searchValue"}},t._l(t.searchOptions,(function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),i("el-card",{directives:[{name:"show",rawName:"v-show",value:0==t.searchValue.length,expression:"searchValue.length==0?true:false"}],staticClass:"searchPlace"},[t._v("\n    请搜索一个电影名称\n  ")]),i("el-card",{directives:[{name:"show",rawName:"v-show",value:!!t.movieList.hasOwnProperty("main_pic"),expression:"movieList.hasOwnProperty('main_pic') ? true : false"}]},[i("div",{staticClass:"left-img"},[i("img",{attrs:{width:"100%",src:this.movieList.main_pic,alt:"图片"}})]),i("div",{staticClass:"right-img"},[i("div",{domProps:{textContent:t._s("片名: "+t.movieList.movie_name)}}),i("div",{domProps:{textContent:t._s("电影类型: "+t.movieList.movie_type)}}),i("div",{domProps:{textContent:t._s("上映地点: "+t.movieList.online_place)}}),i("div",{domProps:{textContent:t._s("语言: "+t.movieList.language)}}),i("div",{domProps:{textContent:t._s("评分: "+t.movieList.kps)}}),i("div",{domProps:{textContent:t._s("播放类型: "+t.movieList.play_type)}}),i("div",{domProps:{textContent:t._s("电影时长: "+t.movieList.time_length)}}),i("div",{staticClass:"about-span"},[t._v("\n        电影简介:\n        "),i("span",[t._v(t._s(t.movieList.movie_about))])])])]),0!=t.movieListAll.length?i("el-card",[i("div",{staticClass:"trailerHeader"},[i("div",[t._v("预告视频>")]),i("div",[i("el-button",{on:{click:t.videoAllBtn}},[t._v("编辑"),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)]),0!=t.movieListAll.length?i("div",{staticClass:"trailer",staticStyle:{height:"250px"}},[i("div",{staticClass:"trailer-preview-box"},t._l(t.movieListAll.video_list.slice(0,10),(function(e,a){return i("div",{key:a,staticStyle:{width:"250px",height:"100%"}},[i("video",{staticClass:"videos",attrs:{src:e.t_path+"#t=5",width:"200px",height:"120px",preload:"metadata",controls:""}}),i("div",{staticStyle:{padding:"0px 10px 0px 10px"}},[t._v("\n            "+t._s(e.title)+"\n          ")])])})),0)]):t._e()]):t._e(),0!=t.movieListAll.length?i("el-card",[i("div",{staticClass:"img-box"},[i("div",{staticClass:"trailerHeader"},[i("div",[t._v("剧照>")]),i("div",[i("el-button",{on:{click:t.imgAllBtn}},[t._v("编辑"),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)]),i("div",{staticClass:"trailer"},[i("div",{staticClass:"trailer-preview-box"},t._l(t.movieListAll.img_list.slice(0,10),(function(t,e){return i("img",{key:e,staticClass:"videos",attrs:{src:t.s_path,width:"250px",height:"90%",preload:"metadata",controls:""}})})),0)])])]):t._e(),0!=t.movieListAll.length?i("el-card",[i("div",{staticClass:"img-box"},[i("div",{staticClass:"trailerHeader"},[i("div",[t._v("参与者>")]),i("div",[i("el-button",{on:{click:t.playAllBtn}},[t._v("编辑"),i("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)]),i("div",{staticClass:"cosplay"},[i("div",{staticClass:"cosplay-preview-box"},t._l(t.movieListAll.actor,(function(e,a){return i("div",{key:a,staticClass:"cosplayBox"},t._l(e.children,(function(e,a){return i("div",{key:a},[i("div",{staticStyle:{height:"120px",overflow:"hidden"}},[i("img",{staticStyle:{margin:"0px 10px 0px 10px"},attrs:{width:"100px",src:e.p_pic,alt:""}})]),i("div",{staticClass:"cosplaySpan"},[t._v("\n                "+t._s(e.p_name)+"\n              ")]),i("div",{staticClass:"cosplaySpan"},["导演"==e.cos_play?i("div",[t._v("\n                  "+t._s(e.cos_play)+"\n                ")]):null==e.cos_play?i("div",[t._v("\n                  "+t._s(e.play_class)+"\n                ")]):i("div",[t._v("饰演:"+t._s(e.cos_play))])])])})),0)})),0)])])]):t._e(),i("el-drawer",{attrs:{title:"编辑>预告视频>",visible:t.videoDrawer,direction:t.direction,size:"93%;border-radius:30px 30px 0px 0px"},on:{"update:visible":function(e){t.videoDrawer=e}}},[i("div",{staticStyle:{height:"90%",overflow:"auto"}},[i("div",{staticClass:"videoPreviewTop"},[i("div",t._l(t.movieListAll.video_list,(function(e,a){return i("div",{key:a,staticClass:"videoPriveBox"},[i("video",{attrs:{width:"100%",height:"150px",preload:"metadata",controls:"",src:e.t_path+"#t=5"}}),i("span",{staticStyle:{width:"100%",overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":"2"}},[t._v(t._s(e.title))]),i("div",{staticStyle:{position:"absolute",bottom:"0",width:"100%","text-align":"center"}},[i("el-button",{staticClass:"edit_el-button--danger",staticStyle:{margin:"0px 10px 0px 10px"},attrs:{type:"primary"},on:{click:function(i){return t.videoEdit(e.id)}}},[i("i",{staticClass:"el-icon-edit"})]),i("el-popconfirm",{attrs:{"confirm-button-text":"好的","cancel-button-text":"不用了",icon:"el-icon-info","icon-color":"red",title:"这是一段内容确定删除吗？"},on:{confirm:function(i){return t.videoDel(e.id)}}},[i("el-button",{staticClass:"del-el-button--danger",staticStyle:{margin:"0px 10px 0px 10px"},attrs:{slot:"reference",type:"danger"},slot:"reference"},[i("i",{staticClass:"el-icon-delete"})])],1)],1)])})),0)])]),i("div",{staticClass:"videoPreviewBottom"},[i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.viedoAddClick()}}},[t._v("添加预告视频")])],1)]),i("el-dialog",{attrs:{title:"编辑",visible:t.editVideoVisible,width:"50%","before-close":t.beforeEditBtnClose},on:{"update:visible":function(e){t.editVideoVisible=e}}},[i("el-form",{ref:"editFormRef",staticClass:"demo-ruleForm",attrs:{model:t.editVideoFormData,"status-icon":"",rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"标题",prop:"title"}},[i("el-input",{attrs:{type:"textarea",autosize:"",autocomplete:"off"},model:{value:t.editVideoFormData.title,callback:function(e){t.$set(t.editVideoFormData,"title",e)},expression:"editVideoFormData.title"}})],1),i("el-form-item",{attrs:{label:"视频url",prop:"t_path"}},[i("el-input",{attrs:{type:"text",autocomplete:"off"},model:{value:t.editVideoFormData.t_path,callback:function(e){t.$set(t.editVideoFormData,"t_path",e)},expression:"editVideoFormData.t_path"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[0==t.isVideoDialog?i("el-button",{attrs:{rows:2},on:{click:function(e){return t.editVideoCancelBtn("editFormRef")}}},[t._v("取 消")]):t._e(),0==t.isVideoDialog?i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.editVideoFinishBtn("editFormRef")}}},[t._v("确 定")]):t._e(),1==t.isVideoDialog?i("el-button",{attrs:{rows:2},on:{click:function(e){return t.addVideoCancelBtn("editFormRef")}}},[t._v("取 消")]):t._e(),1==t.isVideoDialog?i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addVideoFinishBtn("editFormRef")}}},[t._v("添加")]):t._e()],1)],1),i("el-drawer",{attrs:{title:"编辑>参与者>",visible:t.playDrawer,direction:t.direction,size:"93%;border-radius:30px 30px 0px 0px"},on:{"update:visible":function(e){t.playDrawer=e}}},[i("div",{staticClass:"playCLassBox"},t._l(t.movieListAll.actor,(function(e,a){return i("div",{key:a},[i("div",{staticClass:"playClassTitle"},[t._v("\n          "+t._s(e.play_class)+" ("+t._s(e.play_length)+")\n        ")]),t._l(e.children,(function(e,a){return i("div",{key:a,staticStyle:{width:"132px",display:"inline-block",margin:"10px"}},[i("el-checkbox-group",{directives:[{name:"show",rawName:"v-show",value:t.isChecBox,expression:"isChecBox"}],model:{value:t.playTopDelList,callback:function(e){t.playTopDelList=e},expression:"playTopDelList"}},[i("el-checkbox",{attrs:{label:e.id}})],1),i("div",{staticStyle:{height:"120px",overflow:"hidden"}},[i("img",{staticStyle:{margin:"0px 10px 0px 10px"},attrs:{width:"100px",src:e.p_pic,alt:""}})]),i("div",{staticClass:"cosplaySpan"},["导演"==e.cos_play?i("div",[i("div",[t._v("\n                "+t._s(e.cos_play)+"\n              ")]),i("div",[t._v(t._s(e.p_name))])]):"演员"==e.play_class?i("div",[i("div",[t._v("\n                "+t._s(e.p_name)+"\n              ")]),t._v("\n              饰演: "+t._s(e.cos_play)+"\n            ")]):i("div",[i("div",[t._v("\n                "+t._s(e.p_name)+"\n              ")]),t._v("\n              "+t._s(e.cos_play)+"\n            ")])])],1)})),i("div",{staticClass:"playAddBox",on:{click:function(i){return t.rightAddBtn(e.play_class)}}},[i("svg",{attrs:{width:"100%",height:"100%",viewBox:"0 0 220 300",version:"1.1","xmlns:xlink":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/svg"}},[i("desc",[t._v("Created with Lunacy")]),i("defs",[i("rect",{attrs:{width:"220",height:"300",id:"artboard_1"}}),i("clipPath",{attrs:{id:"clip_1"}},[i("use",{attrs:{"xlink:href":"#artboard_1","clip-rule":"evenodd"}})])]),i("g",{attrs:{id:"Honor-View-20","clip-path":"url(#clip_1)"}},[i("use",{attrs:{"xlink:href":"#artboard_1",stroke:"none",fill:"#FFFFFF","fill-opacity":"0"}}),i("g",{attrs:{id:"Group",transform:"translate(9.679199 10)"}},[i("path",{attrs:{d:"M0 0L200.642 0L200.642 276L0 276L0 0Z",id:"Rectangle",fill:"none",stroke:"#808080","stroke-width":"11","stroke-linecap":"round","stroke-linejoin":"round","stroke-dasharray":"18 29 0 0"}}),i("path",{attrs:{d:"M0 1L113 1",transform:"translate(43.8208 138)",id:"Line",fill:"none",stroke:"#808080","stroke-width":"9","stroke-linecap":"round","stroke-linejoin":"round"}}),i("path",{attrs:{d:"M0 0L0 125",transform:"translate(100.3208 75.50001)",id:"Line",fill:"none",stroke:"#808080","stroke-width":"9","stroke-linecap":"round","stroke-linejoin":"round"}})])])])])],2)})),0),i("div",{staticClass:"playCLassBottom"},[i("el-button",{attrs:{type:"success"},on:{click:t.addPlayBtn}},[t._v("\n        添加分类\n      ")]),i("el-button",{attrs:{type:"danger"},on:{click:t.playDelClick}},[t._v("\n        删除\n      ")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:t.playTopDelList.length>0,expression:"playTopDelList.length>0?true:false"}],attrs:{type:"danger"},on:{click:function(e){t.playTopDelList=[],t.isChecBox=!1}}},[t._v("\n        取消选中\n      ")])],1)]),i("el-dialog",{attrs:{title:"",visible:t.addRightVisible,width:"50%","before-close":t.addRightVisibleClose},on:{"update:visible":function(e){t.addRightVisible=e}}},[i("el-form",{ref:"addRightRef",staticClass:"demo-ruleForm",attrs:{model:t.rightPlayForm,rules:t.rules,"label-width":"100px"}},[i("el-alert",{directives:[{name:"show",rawName:"v-show",value:1==t.orPlayAdd,expression:"orPlayAdd==1?true:false"}],staticStyle:{"margin-bottom":"10px"},attrs:{title:"分类要包含一个演员",type:"warning","show-icon":""}}),i("el-form-item",{attrs:{label:"分类",prop:"play_class"}},[i("el-input",{attrs:{disabled:t.isClass},model:{value:t.rightPlayForm.play_class,callback:function(e){t.$set(t.rightPlayForm,"play_class",e)},expression:"rightPlayForm.play_class"}})],1),i("el-form-item",{attrs:{label:"选择人员",prop:"actor_id"}},[i("el-autocomplete",{attrs:{"popper-class":"my-autocomplete","fetch-suggestions":t.querySearch,placeholder:"请输入并选择一个演员"},on:{select:t.handleSelect},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.item;return[i("div",{staticClass:"addPreviewBox"},[i("div",{staticClass:"addPlayPreview"},[i("img",{attrs:{width:"100%",src:a.p_pic,alt:""}})]),i("div",{staticClass:"playName"},[t._v("\n                "+t._s(a.address)+"\n              ")])])]}}]),model:{value:t.rightaddValue,callback:function(e){t.rightaddValue=e},expression:"rightaddValue"}})],1),i("el-form-item",{attrs:{label:"扮演角色",prop:"cos_play"}},[i("el-input",{model:{value:t.rightPlayForm.cos_play,callback:function(e){t.$set(t.rightPlayForm,"cos_play",e)},expression:"rightPlayForm.cos_play"}})],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){return t.addRightCancel("addRightRef")}}},[t._v("取 消")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:0==t.orPlayAdd,expression:"orPlayAdd==0?true:false"}],attrs:{type:"primary"},on:{click:function(e){return t.addRightFinish("addRightRef")}}},[t._v("确定")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.orPlayAdd,expression:"orPlayAdd==1?true:false"}],attrs:{type:"primary"},on:{click:function(e){return t.addPlayFinish("addRightRef")}}},[t._v("添加")])],1)],1),i("el-drawer",{attrs:{title:"编辑>剧照>",visible:t.imgDrawer,direction:t.direction,size:"93%;border-radius:30px 30px 0px 0px"},on:{"update:visible":function(e){t.imgDrawer=e}}},[i("div",{staticClass:"imgbox"},[i("div",{staticClass:"imgBoxTop"},t._l(t.movieListAll.img_list,(function(e,a){return i("div",{key:a,staticStyle:{width:"300px"}},[i("div",{staticStyle:{position:"relative"}},[i("div",{key:a,ref:"delBackground",refInFor:!0,staticClass:"imgdelBackground",staticStyle:{display:"none"}},[i("i",{staticClass:"el-icon-delete-solid"})]),i("img",{key:e.id,ref:"imgref",refInFor:!0,attrs:{width:"90%",src:e.s_path,lazy:"",alt:"加载出错"},on:{click:function(i){1==t.isDel&&t.imgclick(e.id,"imgref",a,"delBackground")}}})])])})),0),i("div",{staticClass:"imgBoxBottom"},[i("el-button",{attrs:{type:"success"},on:{click:t.addImgClick}},[t._v("添加")]),i("el-button",{attrs:{type:"danger"},on:{click:t.delImg}},[t._v("删除")]),i("el-button",{directives:[{name:"show",rawName:"v-show",value:0!=t.delarr.length,expression:"delarr.length==0?false:true"}],attrs:{type:"danger"},on:{click:t.delImgCancel}},[t._v("取消删除")])],1)])]),i("el-dialog",{attrs:{title:"添加剧照",visible:t.addImgVisible},on:{"update:visible":function(e){t.addImgVisible=e}}},[i("el-form",{ref:"addImgFormRef",attrs:{rules:t.rules,model:t.addImgForm}},[i("el-form-item",{attrs:{label:"图片URL",prop:"s_path"}},[i("el-input",{attrs:{autocomplete:"off"},model:{value:t.addImgForm.s_path,callback:function(e){t.$set(t.addImgForm,"s_path",e)},expression:"addImgForm.s_path"}})],1)],1),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:t.addImgCancel}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.addImgFinish("addImgFormRef")}}},[t._v("添加")])],1)],1)],1)},s=[],r=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"loader-layer",class:t.show?"active":""},[t._m(0)])},o=[function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"spinner"},[i("div",{staticClass:"double-bounce1"}),i("div",{staticClass:"double-bounce2"}),t._v("loading...\n  ")])}],l={props:["show"]},d=l,n=(i("de27"),i("2877")),c=Object(n["a"])(d,r,o,!1,null,"cc148194",null),h=c.exports,p={component:{loading:h},data(){var t=(t,e,i)=>{var a=/(http|https):\/\/.+(\.jpg|\.png|\.mp4|\.wav|\.avi|\.mov|\.flv|\.webm)/gi;a.test(e)?i():i(new Error("请输入正确链接"))},e=(t,e,i)=>{""==this.rightPlayForm.actor_id?i(new Error("请选择演员,如果没有,请先添加")):i()};return{loading:!1,searchValue:"",movieList:{},searchOptions:[],movieListAll:[],direction:"btt",isVideoDialog:0,videoDrawer:!1,editVideoVisible:!1,editVideoFormData:{},playDrawer:!1,rightPlayForm:{which_id:this.searchValue,play_class:"",actor_id:"",cos_play:""},addRightVisible:!1,rightAddPlayInput:"",rightaddValue:"",playTopDelList:[],isChecBox:!1,isClass:!0,orPlayAdd:0,imgDrawer:!1,isDel:0,delarr:[],addImgVisible:!1,addImgForm:{s_id:"",s_path:""},rules:{title:[{required:!0,message:"请输入视频标题",trigger:"change"},{min:5,max:500,message:"长度在 5 到 500 个字符",trigger:"change"}],play_class:[{required:!0,message:"请输入一个分类",trigger:"blur"},{min:1,max:10,message:"长度在 1 到 5 个字符",trigger:"blur"}],t_path:[{required:!0,validator:t,trigger:"change"}],s_path:[{required:!0,validator:t,trigger:"change"}],actor_id:[{required:!0,validator:e,trigger:"change"}],cos_play:[{required:!0,message:"请输入视频标题",trigger:"change"},{min:1,max:10,message:"长度在 1 到 10 个字符",trigger:"change"}]}}},methods:{filterMethods(t){""!=t?(console.log(t),this.loading=!0,setTimeout(async()=>{let{data:e}=await this.$axios.get("getinfo/search",{params:{movie_name:t}});if(200!=e.meta.status)return this.$message.error("获取失败");let i=[];e.data.forEach((t,e)=>{console.log(t),i.push({label:t.movie_name,value:t.movie_id})}),this.searchOptions=i,this.loading=!1},500)):this.searchOptions=[]},videoAllBtn(){this.videoDrawer=!0},async videoDel(t){console.log(t);let{data:e}=await this.$axios.delete("updateinfo/video",{params:{id:t}});this.getMovieInfoList()},viedoAddClick(){this.isVideoDialog=1,console.log("触发"),this.editVideoFormData={t_path:"",title:"",t_id:this.searchValue},this.editVideoVisible=!0},addVideoFinishBtn(t){console.log("触发Finish"),this.$refs[t].validate(async t=>{if(!t)return!1;{let{data:t}=await this.$axios.post("/addinfo/video",this.editVideoFormData);if(console.log(t),200!=t.meta.status)return this.$message.error("添加失败");this.$message.success("添加成功"),this.getMovieInfoList(),this.editVideoVisible=!1,this.editVideoFormData={}}})},addVideoCancelBtn(){console.log("触发Cancel"),this.editVideoVisible=!1},async videoEdit(t){this.isVideoDialog=0,console.log(t);let{data:e}=await this.$axios.get("getinfo/trailer/get",{params:{t_id:this.searchValue,id:t}});200!=e.meta.status&&this.$message.error("失败"),this.editVideoFormData=e.data[0],this.editVideoVisible=!0},editVideoFinishBtn(t){this.$refs[t].validate(async t=>{if(!t)return!1;{console.log(this.editVideoFormData);let{data:t}=await this.$axios.post("updateinfo/setVideo",this.editVideoFormData);if(200!=t.meta.status)return this.$message.error("修改失败");console.log(t),this.$message.success(t.meta.msg),this.editVideoVisible=!1}})},editVideoCancelBtn(t){this.$refs[t].resetFields(),this.editVideoVisible=!1},beforeEditBtnClose(){this.$confirm("确认关闭？").then(t=>{this.editVideoVisible=!1,done()}).catch(t=>{})},imgAllBtn(){console.log("触发"),setTimeout(t=>{this.imgDrawer=!0},500)},loadmore(){console.log("触底了")},imgclick(t,e,i,a){if(console.log(t,e),console.log(this.$refs[e][i]),this.$refs[a][i].style.display="flex",this.delarr.push(t),0==this.delarr.length)return this.$message.error("未选择任何图片")},async delImg(){if(this.isDel=1,0==this.delarr.length)return this.$notify.warning("单击图片选择删除");let{data:t}=await this.$axios.delete("/updateinfo/imgdel",{data:{id:this.delarr}});if(200!=t.meta.status)return this.$message.error("删除失败");this.$message.success("删除成功"),this.getMovieInfoList(),this.delImgCancel()},delImgCancel(){let t=this.$refs["delBackground"];for(let e=0;e<t.length;e++)t[e].style.display="none";this.delarr=[],this.isDel=0},addImgClick(){this.addImgVisible=!0},addImgCancel(){this.addImgVisible=!1,this.addImgForm.url="",this.$refs["addImgFormRef"].resetFields()},addImgFinish(t){this.$refs[t].validate(async t=>{if(!t)return this.$notify.error("请输入url");{this.addImgForm.s_id=this.searchValue;let{data:t}=await this.$axios.post("/addinfo/addimg",this.addImgForm);if(200!=t.meta.status)return this.$message.error("添加失败");this.$message.success("添加成功"),this.addImgVisible=!1,this.addImgForm.s_path="",this.getMovieInfoList()}})},playAllBtn(){this.playDrawer=!0,console.log(this.movieListAll)},addPlayBtn(){this.orPlayAdd=1,console.log(),this.isClass=!1,this.addRightVisible=!0},rightAddBtn(t){this.orPlayAdd=0,console.log(t),this.isClass=!0,this.rightPlayForm.which_id=this.searchValue,this.rightPlayForm.play_class=t,this.addRightVisible=!0},addRightVisibleClose(t){this.$confirm("确认关闭？").then(t=>{this.addRightVisible=!1,this.clearRightForm(),this.$refs["addRightRef"].resetFields(),done()}).catch(t=>{})},clearRightForm(t){this.rightPlayForm.play_class="",this.rightPlayForm.actor_id="",this.rightPlayForm.cos_play=""},addRightCancel(){this.$refs["addRightRef"].resetFields(),this.addRightVisible=!1,this.clearRightForm("addRightRef")},addRightFinish(t){this.$refs[t].validate(async t=>{if(!t)return this.$notify.error("请选择必要信息");{let{data:t}=await this.$axios.post("/addinfo/mactor",this.rightPlayForm);if(200!=t.meta.status)return this.$message.error("添加失败");this.$message.success("添加成功"),this.clearRightForm(),this.addRightVisible=!1,this.getMovieInfoList()}})},addPlayFinish(t){this.rightPlayForm.which_id=this.searchValue,console.log(this.rightPlayForm),this.$refs[t].validate(async t=>{if(!t)return this.$notify.error("请选择必要信息");{let{data:t}=await this.$axios.post("/addinfo/mactor",this.rightPlayForm);if(200!=t.meta.status)return this.$message.error("添加失败");this.$message.success("添加成功"),this.addRightVisible=!1,this.clearRightForm(),this.getMovieInfoList()}})},async querySearch(t,e){console.log(t);let{data:i}=await this.$axios.get("/getinfo/actor/get",{params:{p_name:t}});if(200!=i.meta.status)return this.$message.error("获取人员列表失败");let a=[];i.data.forEach((t,e)=>{a.push({value:t,address:t.p_name,p_pic:t.p_pic,id:t.actor_id})}),e(a)},handleSelect(t){this.rightaddValue=t.value.p_name,this.rightPlayForm.actor_id=t.value.p_id,console.log(t),console.log(this.rightPlayForm)},async playDelClick(){if(this.isChecBox=!0,this.playTopDelList,0==this.playTopDelList.length)return this.$notify.warning("没有选择删除项");let{data:t}=await this.$axios.delete("/updateinfo/playdel",{data:{id:this.playTopDelList}});if(200!=t.meta.status)return this.$message.error("删除失败");this.$message.success("删除成功"),this.playTopDelList=[],this.getMovieInfoList(),this.isChecBox=!1},async getMovieInfoList(){let{data:t}=await this.$axios.get("getinfo/info",{params:{movie_id:this.searchValue,tree:1}});if(200!=t.meta.status)return this.$message.error("获取失败");this.movieListAll=t.data}},computed:{},mounted(){},watch:{async searchValue(){console.log("改变");let{data:t}=await this.$axios.get("getinfo/movie",{params:{id:this.searchValue}});if(console.log(t),200!=t.meta.status)return this.$notify.error("获取失败");this.movieList=t.data,this.getMovieInfoList()},playTopDelList(){console.log(this.playTopDelList)}}},m=p,u=(i("089d"),Object(n["a"])(m,a,s,!1,null,"cf44b2c8",null));e["default"]=u.exports},"2d47":function(t,e,i){"use strict";i("d8b3")},"616e":function(t,e,i){},d170:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/"}}},[t._v("首页")]),i("el-breadcrumb-item",[t._v("电影管理")]),i("el-breadcrumb-item",[t._v("添加人员")])],1),i("el-card",{staticClass:"main_card"},[i("el-form",{ref:"ruleForm",attrs:{model:t.addActorInfo,rules:t.rules,"label-width":"100px"}},[i("el-row",{attrs:{align:"bottom"}},[i("el-card",[i("el-col",{staticClass:"add-movie-img-path",attrs:{span:5}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!(t.addActorInfo.p_pic.length>0),expression:"addActorInfo.p_pic.length > 0 ? false : true"}],staticClass:"main_pic_preview"}),i("img",{directives:[{name:"show",rawName:"v-show",value:0!=t.addActorInfo.p_pic.length,expression:"addActorInfo.p_pic.length == 0 ? false : true"}],staticClass:"main_pic",attrs:{src:t.addActorInfo.p_pic}})]),i("el-col",{attrs:{span:10}},[i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"头像url",prop:"p_pic"}},[i("el-input",{model:{value:t.addActorInfo.p_pic,callback:function(e){t.$set(t.addActorInfo,"p_pic",e)},expression:"addActorInfo.p_pic"}})],1)],1)],1),i("el-row",[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"人员名称",prop:"p_name"}},[i("el-input",{model:{value:t.addActorInfo.p_name,callback:function(e){t.$set(t.addActorInfo,"p_name",e)},expression:"addActorInfo.p_name"}})],1)],1)],1),i("el-row",[i("el-form-item",{attrs:{label:"生日",prop:"birthday"}},[i("el-col",{attrs:{span:24}},[i("el-date-picker",{attrs:{type:"date",placeholder:"选择生日"},model:{value:t.addActorInfo.birthday,callback:function(e){t.$set(t.addActorInfo,"birthday",e)},expression:"addActorInfo.birthday"}})],1)],1)],1)],1)],1)],1),i("el-card",{staticStyle:{"margin-top":"10px"}},[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:24}},[i("el-form-item",{attrs:{label:"人员简介",prop:"about"}},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入人员简介"},model:{value:t.addActorInfo.about,callback:function(e){t.$set(t.addActorInfo,"about",e)},expression:"addActorInfo.about"}})],1)],1),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"背景图",prop:"p_pic"}},[i("el-input",{model:{value:t.addActorInfo.background,callback:function(e){t.$set(t.addActorInfo,"background",e)},expression:"addActorInfo.background"}})],1)],1),i("el-col",{attrs:{span:8}},[i("el-form-item",{attrs:{label:"籍贯",prop:"native_place"}},[i("el-input",{model:{value:t.addActorInfo.native_place,callback:function(e){t.$set(t.addActorInfo,"native_place",e)},expression:"addActorInfo.native_place"}})],1)],1)],1)],1),i("el-card",{staticStyle:{"margin-top":"10px"}},[i("el-row",[i("el-col",{staticClass:"addBtn",attrs:{span:24}},[i("el-button",{attrs:{type:"success"},on:{click:function(e){return t.addActorBtn("ruleForm")}}},[t._v("添加")])],1)],1)],1)],1)],1)],1)},s=[],r={data(){var t=(t,e,i)=>{var a=/(http|https):\/\/.+(\.jpg|\.png)/gi;a.test(e)?i():i(new Error("请输入正确链接"))};return{addActorInfo:{p_name:"",p_pic:"",birthday:"",about:"",native_place:"",background:""},rules:{native_place:[{required:!0,message:"请输入籍贯",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],p_name:[{required:!0,message:"请输入演员名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],birthday:[{type:"date",required:!0,message:"请选择日期",trigger:"change"}],p_pic:[{validator:t,trigger:"blur"}],about:[{required:!0,message:"请输入电影简介(10-500个字符)",trigger:"blur"},{min:10,max:500,message:"长度在 10 到 500 个字符",trigger:"blur"}]}}},methods:{async addActorBtn(t){this.$refs[t].validate(async t=>{if(!t)return this.$notify({title:"警告",message:"请输入完整的人员信息",type:"warning"}),!1;{let{data:t}=await this.$axios.post("addinfo/addActor",this.addActorInfo);if(console.log(t),200!=t.meta.status)return this.$notify.error(""+t.meta.msg);this.$notify.success("添加成功"),console.log(t)}})}},computed:{formatDate(){let t=this.addActorInfo.birthday.getFullYear(),e=this.addActorInfo.birthday.getMonth(),i=this.addActorInfo.birthday.getDate();return`${t}-${e}-${i}`}}},o=r,l=(i("2d47"),i("2877")),d=Object(l["a"])(o,a,s,!1,null,"44032e87",null);e["default"]=d.exports},d8b3:function(t,e,i){},de27:function(t,e,i){"use strict";i("616e")},e6aa:function(t,e,i){}}]);
//# sourceMappingURL=detail.45c74a79.js.map